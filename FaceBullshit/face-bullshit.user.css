/* ==UserStyle==
@name           FaceBullshit
@namespace      https://l.flandre.tw/github/stylus-usercss
@version        4.0.3
@description    Beautify Facebook 2025 layout
@author         FlandreDaisuki<github@flandre.tw>
@license        CC-BY-SA-4.0
@updateURL      https://stylus-usercss.flandre.tw/FaceBullshit/face-bullshit.user.css

@preprocessor stylus
@var text custom-chatroom-height        "小聊天室高度"    92vh
@var checkbox no-ig                     "不要 instagram" 1
@var checkbox no-friends-recommandation "不要推薦朋友"    1
@var checkbox hide-non-followed-posts   "隱藏未追蹤貼文"   1
==/UserStyle== */
@-moz-document domain("www.facebook.com"), domain("m.facebook.com") {
  a[aria-label="Facebook"] {
    & > svg {
      visibility: hidden;
    }
    background-repeat: no-repeat;
    background-size: cover;
    background-image: var(--icon-poop);
  }

  /* 桌面版 layout */
  @media screen and (min-width: 1280px) {
    div:has( > [role="navigation"] ~ [role="main"] ~ [role="complementary"]) {
      max-width: 100%;
    }

    /* 動態靠左 */
    [role="main"] {
      justify-content: flex-start;
    }
  }

  /* 右側欄 Sponsored */
  [role="complementary"] div:has( + [data-thumb] + [data-thumb]) div:first-child:not([class]):has( + [data-visualcompletion="ignore-dynamic"]) {
    display: none;
  }

  /* 小聊天室 root */
  [class^="x"]:has( ~ form[action*="logout"]) > [class^="x"] > [class^="x"] {
    right: 10rem;
  }

  /* 小聊天室 */
  [style*="--chat-composer"] > [tabindex] > [role="none"] > div {
    height: custom-chatroom-height;
  }

  if (no-ig) {
    [data-virtualized="false"]:has([data-visualcompletion="ignore-dynamic"][role="region"]) {
      display: none;
    }

    /* m.facebook.com */
    [data-type="vscroller"] > [class*="otf"] + [data-type="container"] {
      display: none;
    }
  }

  if (no-friends-recommandation) {
    div:has( > [style^="border"][style*="card-corner-radius"] + div:empty) {
      display: none;
    }

    /* m.facebook.com */
    [data-type="vscroller"] > [data-type="container"]:has([data-type="text"] + [data-type="container"] + [data-type="container"]) {
      display: none;
    }
  }

  if (hide-non-followed-posts) {
    /* 未追蹤貼文 */
    [aria-posinset]:has(h4 > span:not([class]) > span:not([class]) [role="button"]) {
      display:none;
    }

    /* 未加入社團 */
    [aria-posinset]:has(h4 [role="button"] [role="none"]) {
      display: none;
    }
  }

  :root {
    --icon-poop: url("data:image/webp;base64,UklGRkADAABXRUJQVlA4WAoAAAAQAAAAJwAAJwAAQUxQSHABAAABkCzJtmlb8/hc27at5r3Ptlu2/Xrv9Wzbtm3btm2vozUfNtZcXxAREwBim90aFgQyWke52DQrnSVi5BdER2MqQ+moi4iIfKGRqNpDDyputNAE7EZlPgJo/bZypTtpFIbgWv1OepTmRtkN4gr3uFGd3VjaJkJU3m3U+f1Ue28h3vPdehA98xMNAmKvoUDP6gABCbdEIO8mwH8bF4EH7Hr8ag065RHyPFabrfFBB0exz7RZ+n5E4Uftmipfo/ihJi2WtUj4YLCvmiHuNQWy4UYVqPhNgp/rqhUzGtwSoJLwluhFiYp5GdHXxgYlQzsXzY82CpbMjueR9kN1AIDAYQ9dSHwpAgD8Zv1CamcXEwA0/4Z0uwakA+xFGR23Gxs/S4F4Jwsl5VNlwUcOWfCsNL2YJC+jdnAp+ARD3PIvbjrXgVgAe52Jx57+dFOwR9PT4X9raE6jnuM2n77z+BNzK3DGvrx/dffuhfPn9szokG0HAFZQOCCqAQAAcAoAnQEqKAAoAD8peq1Oriajoic4C2nAJQpkALhj6EFas6H/eIBZe1rruHXynkJ/tetvugWEWMy6Idyz4mUrvwgRc+hu5SFHCrt0mxufzV7eRJ32HhGXdSUN7gAA/vdNY46bsGAjKAjZXXjO8+5Dwr4YkC+OntSoI1LfQ6YMUqX8X2EG8oDu+6jXLMcUBpGpF3S+SJvYC/qimFFJ/mp3AHIbipLTnDk1LjuBrNUfzLl//22pkIxVaw6LbH1aoI1xqizDwVNVrshNABkuTJ6b9k9FXmkf9hlfRchm+bTwh/YohKeKcibLCWO+yfP9M6V4YmpylbEugwc0qlO3MCdALZoDfE6jEBpl+42BNE723qPn1YP+ti2eTdROQexK+gBWPtqL+LIqgzQfPyt+ondFziiLobS84vMVFc3in9asUwn6H9jXTPib11KxnBgO4kf+H24Hp6+122H/feh0iKG3Zx0+9zPYJ28vJSKCO9M/5vm/B+h9aYV9Nb+97KRNKYh9KKWxrNVsDnnct0WrQtoa2aTEt4+klRytKIpKgyXMFNgVC/G/PtQLIMAA");
  }
}
